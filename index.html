<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport"
     content="width=device-width, initial-scale=1, user-scalable=yes">
  <script
  src="https://code.jquery.com/jquery-2.2.4.min.js"
  integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
  crossorigin="anonymous"></script>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="css/style.css">
  <title> Campus Community Connections </title>
</head>
<body>

  <div class="container">
    <div class="head-s">
    <div class="row">
      <div class="col-md-1">
        <img src="logoweb.png" alt="logo">
      </div>
      <div class="col-md-9"></div>
      <div class="col-md-2">
        <a class="btn btn-default" href='https://goo.gl/forms/CGionRn90ootRY4I2' target="_blank">Propose New Project</a>
      </div>
    </div>
    <div class="row">
          <div class="col-md-8">
            <h1>Campus Community Connections</h1>
          
          </div>
        <div class="col-md-4"></div>

    </div>
    <div class="row">
      <div class="col-md-6">
        <h3>Engage with projects in your community or propose a new one!</h3>
      </div>
      <div class="col-md-6"></div>
    </div>
    

    <div class="row">
      
      <div class="col-md-10">
            <input id="myInput" type="text" onkeyup="filterTable()" placeholder="Search by keyword or community...">
      </div>
      <div class="col-md-2"></div>
    </div>
    <div class="row">
      <div class="col-md-2">
          <input id="CP" class="btn" type="button" value="College Park" onclick="buttonFilter('College Park');" />
      </div>
      <div class="col-md-2">
          <input id="HV" class="btn" type="button" value="Hyattsville" onclick="buttonFilter('Hyattsville');" />
      </div>
      <div class="col-md-2">
          <input id="RP" class="btn" type="button" value="Riverdale Park" onclick="buttonFilter('Riverdale Park');" />
      </div>
      <div class="col-md-2">
          <input id="UP" class="btn" type="button" value="University Park" onclick="buttonFilter('University Park');" />
      </div>
      <div class="col-md-2">
          <input id="PG" class="btn" type="button" value="PG County" onclick="buttonFilter('Prince George\'s County');" />
      </div>
      <div class="col-md-2"></div>
    </div>
      
  </div>

  <div class="row">
      <div class="col-md-4">
        <h2>Project List</h2>
      </div>
      <div class="col-md-8"></div>
  </div>
<div class="row">
    <div id="org_table">
      <table id="table" class="col-md-12">
            <tbody id="tableB">

            </tbody>
            
      </table>
    </div>
</div>
</div>

<script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>
<script type='text/javascript'>
  var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/12TaWxdp5gRuULZsBL2eGdM01NpohOHqyKRv9-HGL2ZU/edit?usp=sharing';

  function init() {
    Tabletop.init( { key: 'https://docs.google.com/spreadsheets/d/12TaWxdp5gRuULZsBL2eGdM01NpohOHqyKRv9-HGL2ZU/edit?usp=sharing',
                     callback: showInfo,
                     simpleSheet: true } )
  }

  function showInfo(data, tabletop) {
    alert('Successfully processed!')
    console.log(data[0]);
    var tableBody = '';
    var tableHead = '<tr>;';

    var columns = ['name', 'category', 'municipality'];

    //tableHead.replace('<th>'+i+'</th>','');
    tableHead+='</tr>';

    for (var k =0; k< data.length; k++){
      tableBody+='<tr><td>+</td>';

      for(var l = 0; l < columns.length; l++) {
        tableBody+='<td>'+data[k][columns[l]]+'</td>';
      }

      tableBody+='</tr><tr><td colspan="3"><p>' +data[k]['description']+ '</p></td></tr>';

      }


    //tableBody.replace('<td>'+data[k][l]+'</td>','');


    document.getElementById("tableB").innerHTML = tableBody;
}

  window.addEventListener('DOMContentLoaded', init)

function filterTable(event) {
    var input = document.getElementById("myInput");
    var filter = input.value.toUpperCase();
    var trable = document.getElementById("tableB");
    var tr = trable.getElementsByTagName("tr");
    for (var i = 0; i < tr.length; i++) {
      //console.log(tr.textContent);
        if (tr[i].textContent.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
        } else {
            tr[i].style.display = "none";
        }
    }
}
function buttonFilter(area) {
    var trable = document.getElementById("tableB");
    var tr = trable.getElementsByTagName("tr");
    for (var i = 0; i < tr.length; i++) {
      //console.log(tr.textContent);
        if (tr[i].textContent.indexOf(area) > -1) {
            tr[i].style.display = "";
        } else {
            tr[i].style.display = "none";
        }
    }
}
$(function() {
    $("td[colspan=3]").find("p").hide();
    $("tbody").click(function(event) {
        event.stopPropagation();
        var $target = $(event.target);
        if ( $target.closest("td").attr("colspan") > 1 ) {
            $target.slideUp();
            $target.closest("tr").prev().find("td:first").html("+");
        } else {
            $target.closest("tr").next().find("p").slideToggle();
            if ($target.closest("tr").find("td:first").html() == "+")
                $target.closest("tr").find("td:first").html("-");
            else
                $target.closest("tr").find("td:first").html("+");                
        }                    
    });
});
document.querySelector('#myInput').addEventListener('keyup', filterTable, false);
</script>
</html>
